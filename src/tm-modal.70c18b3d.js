import{q as e,v as l,u as t,x as a,y as o,z as n,o as r,c as s,w as i,b as u,a2 as d,D as c,aa as f,a5 as p,E as y,G as h,f as m,C as v,K as x,A as b,j as k,V as g}from"./index-f5cba0e4.js";import{t as w}from"./tm-translate.1353da0c.js";import{t as _}from"./tm-text.d010834d.js";import{_ as C}from"./tm-icon.ed97db34.js";import{t as S}from"./tm-overlay.d3e45220.js";import{_ as B}from"./tm-sheet.38d3d718.js";import{c as N,u as T,e as z,a as D,b as j,d as I}from"./uni-app.es.62a9cda9.js";import{_ as L}from"./_plugin-vue_export-helper.1b428a4d.js";const A=L(e({__name:"tm-modal",props:{...N,mask:{type:[Boolean],default:!1},border:{type:Number,default:2},show:{type:[Boolean],default:!1},width:{type:Number,default:600},height:{type:Number,default:450},round:{type:Number,default:10},duration:{type:Number,default:250},overlayClick:{type:Boolean,default:!0},transprent:{type:[Boolean],default:!1},closeable:{type:[Boolean],default:!1},color:{type:String,default:"white"},title:[String],okText:{type:[String],default:"完成"},okColor:{type:[String],default:"primary"},okLinear:{type:[String],default:""},okLlinearDeep:{type:[String],default:"accent"},cancelColor:{type:[String],default:"primary"},cancelText:{type:[String],default:"取消"},cancelLinear:{type:[String],default:""},cancelLlinearDeep:{type:[String],default:"accent"},btnRound:{type:Number,default:24},hideCancel:{type:[Boolean],default:!1},splitBtn:{type:Boolean,default:!1},beforeClose:{type:Function,default:()=>()=>!0},content:{type:String,default:""},disabled:{type:Boolean,default:!1},titleStyle:{type:[Array,String,Object],default:()=>[]},zIndex:{type:[Number,String],default:999},teleport:{type:Boolean,default:!0}},emits:["click","open","close","update:show","ok","cancel"],setup(e,{expose:N,emit:L}){var A;const E=e,R=l(null),$=l(null),K=T();null==(A=t())||A.proxy;const O=a((()=>K.tmStore)),P=a((()=>z(E))),U=a((()=>D(E))),q=a((()=>j(E,O.value))),F=a((()=>I(E,q.value,O.value)));let G=null,J=null,V=!1,Y=null;const H=l(!0);let M=!1;uni.$tm.u.getUid(4);const Q=l(!1);let W=l(E.show),X=NaN;function Z(e,l=500,t=!1){if(isNaN(X)||clearTimeout(X),t){var a=!X;X=setTimeout((()=>{X=NaN}),l),a&&"function"==typeof e&&e()}else X=setTimeout((()=>{"function"==typeof e&&e()}),l)}function ee(e,l=500,t=!0){t?M||(M=!0,"function"==typeof e&&e(),setTimeout((()=>{M=!1}),l)):M||(M=!0,setTimeout((()=>{M=!1,"function"==typeof e&&e()}),l))}o((()=>E.show),(e=>{e?fe():pe()})),n((()=>{W.value&&fe()}));const le=a((()=>"round-"+E.round)),te=a((()=>"zoom"!=ae.value?H.value:!H.value)),ae=a((()=>"zoom")),oe=a((()=>E.width+"rpx")),ne=a((()=>E.height+"rpx")),re=a((()=>{let e=0;return E.splitBtn&&(e=v(64)),v(E.height)-44-v(90)-e+"px"})),se=a((()=>"flex-center"));async function ie(){E.disabled||Z((async()=>{try{if("function"==typeof E.beforeClose){Q.value=!0;let e=await E.beforeClose();if("function"==typeof e&&(e=await e()),Q.value=!1,!e)return}L("ok",x(Y)),V=!0,pe()}catch(e){Q.value=!1}}),250,!0)}function ue(){E.disabled||Q.value||(V=!1,L("cancel",x(Y)),pe())}function de(){b((function(){var e;null==(e=R.value)||e.play()})),L("open"),L("update:show",!0),W.value=!0}function ce(){b((()=>{L("close"),L("update:show",!1),W.value=!1,J&&V&&J(),G&&!V&&G()}))}function fe(){E.disabled||Q.value||1!=W.value&&Z((()=>{var e;H.value=!0,W.value=!0,null==(e=$.value)||e.open(!0)}),E.duration,!0)}async function pe(e=null){var l,t;H.value=!1,R.value&&(null==(l=$.value)||l.close(),null==(t=R.value)||t.play())}function ye(e){0!=W.value&&(L("click",e),E.overlayClick&&!E.disabled&&!Q.value&&$.value&&(H.value=!1,ee((()=>{var e,l;V=!1,null==(e=$.value)||e.close(),null==(l=R.value)||l.play()}),E.duration,!0)))}return N({close:pe,open:function(e=null){if(!Q.value&&1!=W.value)return new Promise(((l,t)=>{ee((async()=>{var a;H.value=!0,null==(a=$.value)||a.open(!0),Y=e,G=t,J=l}),E.duration,!0)}))}}),(l,t)=>{const a=k,o=g;return r(),s(a,null,{default:i((()=>[u(a,{onClick:fe},{default:i((()=>[d(l.$slots,"trigger",{},void 0,!0)])),_:3}),u(S,{zIndex:E.zIndex,ref_key:"overlayAni",ref:$,blur:"",duration:E.duration,onClose:ce,onOpen:de,onClick:ye,align:c(se),overlayClick:!1,show:c(W),"onUpdate:show":t[1]||(t[1]=e=>f(W)?W.value=e:W=e),teleport:E.teleport},{default:i((()=>[u(w,{reverse:c(te),width:c(oe),height:c(ne),ref_key:"drawerANI",ref:R,"auto-play":!1,name:c(ae),duration:E.duration},{default:i((()=>[u(a,{onClick:t[0]||(t[0]=p((e=>e.stopPropagation()),["stop"])),style:y([{width:c(oe),height:c(ne),boxSizing:"border-box"},E.transprent?"":c(F).borderCss,E.transprent?"":c(F).backgroundColorCss,E.transprent?"":c(F).shadowColor,c(P)]),class:h([c(le),"flex flex-col overflow ",c(U)])},{default:i((()=>[u(a,{class:h(["flex flex-row px-24",[E.closeable?"flex-row-center-between":"flex-center"]]),style:{height:"44px"}},{default:i((()=>[d(l.$slots,"title",{},(()=>[u(_,{_style:E.titleStyle,dark:E.dark,followTheme:!1,_class:"text-overflow-1 text-weight-b text-size-m text-align-center",label:E.title},null,8,["_style","dark","label"])]),!0),e.closeable?(r(),s(C,{key:0,_class:"opacity-3",name:"tmicon-times-circle-fill",fontSize:32,onClick:pe})):m("",!0)])),_:3},8,["class"]),u(o,{"scroll-y":"",style:y([E.height?{height:c(re)}:""])},{default:i((()=>[u(a,{class:"px-32"},{default:i((()=>[d(l.$slots,"default",{},(()=>[u(_,{"font-size":30,dark:E.dark,followTheme:!1,label:E.content,_style:"line-height:46rpx"},null,8,["dark","label"])]),!0)])),_:3})])),_:3},8,["style"]),u(a,{class:h(["flex flex-row",[E.splitBtn?"pa-32":""]])},{default:i((()=>[d(l.$slots,"button",{},(()=>[E.hideCancel?m("",!0):(r(),s(a,{key:0,class:"flex-1 overflow",style:{height:"90rpx"}},{default:i((()=>[u(B,{dark:E.dark,followTheme:!0,isDisabledRoundAndriod:!0,onClick:ue,height:90,linear:E.cancelLinear,linearDeep:E.cancelLlinearDeep,text:"",color:E.cancelColor,_class:["flex-center overflow flex"],"paren-class":E.splitBtn?"round-"+E.btnRound:"round-bl-"+E.round,margin:[0,0],padding:[0,0]},{default:i((()=>[u(_,{_class:"text-weight-b",_style:"line-height:90rpx",dark:E.dark,followTheme:!1,userInteractionEnabled:!1,label:E.cancelText},null,8,["dark","label"])])),_:1},8,["dark","linear","linearDeep","color","paren-class"])])),_:1})),E.splitBtn&&!E.hideCancel?(r(),s(a,{key:1,class:"overflow",style:{width:"24rpx"}})):m("",!0),u(a,{class:h(["flex-1 flex",[Q.value?"opacity-5":"","overflow"]]),style:{height:"90rpx"}},{default:i((()=>[u(B,{paretClass:"flex-1",class:"flex-1",dark:E.dark,followTheme:!0,isDisabledRoundAndriod:!0,onClick:ie,height:90,linear:E.okLinear,linearDeep:E.okLlinearDeep,color:E.okColor,margin:[0,0],_class:["flex-center overflow"],"paren-class":E.splitBtn?"round-"+E.btnRound:"round-br-"+E.round,padding:[0,0]},{default:i((()=>[u(a,{userInteractionEnabled:!1,class:"flex flex-row"},{default:i((()=>[Q.value?(r(),s(a,{key:0,class:"pr-10"},{default:i((()=>[u(C,{userInteractionEnabled:!1,name:"tmicon-shuaxin",spin:""})])),_:1})):m("",!0),u(_,{_class:"text-weight-b",dark:E.dark,userInteractionEnabled:!1,label:E.okText},null,8,["dark","label"])])),_:1})])),_:1},8,["dark","linear","linearDeep","color","paren-class"])])),_:1},8,["class"])]),!0)])),_:3},8,["class"])])),_:3},8,["style","class"])])),_:3},8,["reverse","width","height","name","duration"])])),_:3},8,["zIndex","duration","align","show","teleport"])])),_:3})}}}),[["__scopeId","data-v-d0ae6b68"]]);export{A as _};
