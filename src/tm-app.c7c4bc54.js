import{q as a,x as t,v as o,X as e,z as r,y as l,aw as n,ax as u,a as i,ay as s,a1 as c,o as d,c as f,w as g,a2 as b,b as m,e as v,E as p,D as k,l as h,j as C}from"./index-f5cba0e4.js";import{c as y,u as S,o as B}from"./uni-app.es.62a9cda9.js";import{u as x}from"./useTheme.d1454919.js";import{u as $}from"./useWindowInfo.47d82cea.js";import{_}from"./_plugin-vue_export-helper.1b428a4d.js";const D=_(a({__name:"tm-app",props:{...y,transprent:{type:[Boolean,String],default:!1},transparent:{type:[Boolean,String],default:!1},theme:{type:String,default:"grey-5"},bgImg:{type:String,default:""},bgStyle:{type:String,default:""},color:{type:String,default:"grey-4"},darkColor:{type:String,default:"#050505"},blur:{type:[Boolean,String],default:!1},navbar:{type:Object,default:()=>({background:"",fontColor:""})},navbarDarkAuto:{type:Boolean,default:!0}},setup(a,{expose:y}){const _=a,D=S(),w=t((()=>D.tmStore)),I=o(!1),{dark:O,isNvue:T,customCSSStyle:j,customClass:N,parentClass:A,transparent:M,_props:J,proxy:F,blur:L,round:z,margin:V,padding:q,theme:E}=x(t((()=>_)),w),P=E();let R=!1,W=e().pop();const X=t((()=>_.bgStyle));let G=$(),H=o({width:G.width,height:G.height,theme:P.value.backgroundColor,bgImg:_.bgImg,dark:O.value});function K(){var a,t,o;if(O.value?H.value.theme=(null==(o=null==(t=null==(a=D.tmuiConfig)?void 0:a.themeConfig)?void 0:t.dark)?void 0:o.bodyColor)||_.darkColor:H.value.theme=P.value.backgroundColor,document.body.style.background=H.value.theme||"",localStorage.setItem("tmuiNavStyle",JSON.stringify({navbarBackground:O.value?H.value.theme:_.navbar.background,navbarFontColor:O.value?"#ffffff":_.navbar.fontColor})),O.value){try{!uni.$tm.isOpenDarkModel&&_.navbarDarkAuto&&n({backgroundColor:"#000000",frontColor:"#ffffff"}).catch((a=>{}))}catch(e){}R&&-1==uni.$tm.tabBar.selectedColor.indexOf("@")&&u({backgroundColor:"#141415",borderStyle:"black",color:"#ffffff",selectedColor:uni.$tm.tabBar.selectedColor||P.value.textColor}).catch((a=>{}))}else{try{let a=uni.$tm.pages.filter((a=>a.path==(null==W?void 0:W.route)));if(a.length>0&&!_.navbar.background){if(a[0].navigationBarTextStyle.indexOf("@")>-1)return;let t=a[0].navigationBarTextStyle;t=t.toLocaleLowerCase(),t="black"==t?"#000000":t,t="white"==t?"#ffffff":t,_.navbarDarkAuto&&n({backgroundColor:a[0].navigationBarBackgroundColor,frontColor:t}).catch((a=>{})),i("tmuiNavStyle",JSON.stringify({navbarBackground:a[0].navigationBarBackgroundColor,navbarFontColor:t}))}else uni.$tm.isOpenDarkModel||(_.navbarDarkAuto&&n({backgroundColor:_.navbar.background,frontColor:_.navbar.fontColor}).catch((a=>{})),i("tmuiNavStyle",JSON.stringify({navbarBackground:_.navbar.background,navbarFontColor:_.navbar.fontColor})))}catch(e){}try{R&&!uni.$tm.isOpenDarkModel&&u({backgroundColor:uni.$tm.tabBar.backgroundColor||_.navbar.background,borderStyle:uni.$tm.tabBar.borderStyle||"white",color:uni.$tm.tabBar.color||_.navbar.fontColor,selectedColor:uni.$tm.tabBar.selectedColor||P.value.textColor}).catch((a=>{}))}catch(e){}}I.value=!0}function Q(a){let t=!O.value;void 0!==a&&"boolean"==typeof a&&(t=a),H.value.dark=t,D.setTmVuetifyDark(t),K()}B((a=>{var t;try{null==(t=D.tmuiConfig.router)||t.useTmRouterAfter({path:(null==W?void 0:W.route)??"",opts:a,context:F??null})}catch(o){}})),r((()=>{!function(){var a;let t=(null==(a=uni.$tm.tabBar)?void 0:a.list)??[];for(let o=0;o<t.length;o++)if((null==W?void 0:W.route)==t[o].pagePath){R=!0;break}D.tmuiConfig.autoDark?window.matchMedia("(prefers-color-scheme: dark)").matches?U("dark"):U("light"):K()}()})),l([()=>w.value.color,O],(()=>{I.value=!1,K()})),l([()=>_.color],(()=>{H.value.theme=P.value.backgroundColor}));try{s((a=>{U(a.theme)}))}catch(Y){console.warn("没有主题切换功能：",Y)}function U(a){D.tmuiConfig.autoDark&&("light"===a?Q(!1):"dark"===a&&Q(!0))}return c("appTextColor",t((()=>P.value.textColor))),c("custom_space_size",[0,0]),y({setTheme:function(a){D.setTmVuetifyTheme(a)},setDark:Q}),(a,t)=>{const o=h,e=C;return d(),f(e,{class:"flex relative app flex-1",style:p([k(H).theme?{background:k(M)?"":k(H).theme}:"",k(J).bgImg?{backgroundImage:`url(${k(J).bgImg})`}:"",k(X)])},{default:g((()=>[b(a.$slots,"default",{},(()=>[m(o,null,{default:g((()=>[v("在这里放置内容")])),_:1})]),!0)])),_:3},8,["style"])}}}),[["__scopeId","data-v-95893e47"]]);export{D as _};
