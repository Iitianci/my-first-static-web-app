import{_ as t}from"./tm-message.42d12b93.js";import{a as e,P as i,n as s,o as l,c as a,w as o,j as n,b as _,d as r,r as c,F as d,h,f as m,p as u,i as f,Z as g,S as p,W as x,k as y}from"./index-f5cba0e4.js";import{r as w}from"./uni-app.es.62a9cda9.js";import{_ as v}from"./tm-tabs.492def44.js";import{_ as b}from"./tm-skeleton-line.9799a71e.js";import{_ as k}from"./tm-sheet.38d3d718.js";import{_ as z}from"./tm-icon.ed97db34.js";import{_ as j}from"./tm-app.c7c4bc54.js";import{g as T,a as C}from"./api.f04a1197.js";import{t as I}from"./tm-text.d010834d.js";import{_ as S}from"./_plugin-vue_export-helper.1b428a4d.js";import"./useWindowInfo.47d82cea.js";import"./tm-badge.vue_vue_type_script_setup_true_lang.38983ab0.js";import"./useTheme.d1454919.js";const N=S({components:{avatarCard:S({name:"avatar-card",emits:["change_full_status","to_change_choose","click_down"],props:{first_loding:{type:String,default:""},action:{type:String,default:"view"},material_item:{type:Object,default:{}},index:{type:Number,default:66}},data:()=>({vk:uni.vk,current_item:{},current_index:0,windowHeight:""}),computed:{},methods:{change_full_status(t){console.log("子status",t),this.$emit("change_full_status",t)},async click_down(){console.log("下载",this.current_index);let t=this.material_item.item_list[this.current_index].cloud_url;this.$emit("click_down",{down_url:t,down_type:"img"})},to_change_choose(t,l){this.current_index=l,this.current_item=t;let a=this.material_item.item_list[this.current_index].cloud_url;e("img_list",[a]);let o={need_jump:!1,need_check_ad_review:!0,in_time:i((new Date).getTime()),item:{type_text:"avatar"}};s({url:`/pages/matetial/detail?extraData=${encodeURIComponent(JSON.stringify(o))}`})},async next_item(){if(this.current_index>=this.material_item.item_list.length-1)return console.log("no more"),void uni.vk.toast("没有更多了","none");this.current_index++,this.current_item=this.material_item.item_list[this.current_index]},before_item(){if(this.current_index<=0)return console.log("is the first"),void uni.vk.toast("已经是第一个","none");this.current_index--,this.current_item=this.material_item.item_list[this.current_index]},start(t){this.clientX=t.changedTouches[0].clientX,this.clientY=t.changedTouches[0].clientY},async end(t){const e=t.changedTouches[0].clientX-this.clientX,i=t.changedTouches[0].clientY-this.clientY;i>50||e>50?(console.log("下滑或左划"),this.before_item()):(i<-50||e<-50)&&(console.log("上滑或右划"),this.next_item())},exit_full(){this.is_full=!1,this.change_full_status(this.is_full)}}},[["render",function(e,i,s,p,x,y){const v=w(h("tm-message"),t),j=w(h("tm-skeleton-line"),b),T=n,C=w(h("tm-sheet"),k),S=u,N=f,Q=w(h("tm-text"),I),$=w(h("tm-icon"),z),F=g;return l(),a(T,null,{default:o((()=>[_(v,{ref:"toast"},null,512),s.first_loding?(l(),r(d,{key:0},c(10,((t,e)=>_(T,null,{default:o((()=>[_(C,{_class:"shadow-1 round-5",class:"round-5",padding:[20,30],margin:[25,10]},{default:o((()=>[_(T,{class:"flex flex-row flex-start"},{default:o((()=>[_(T,{class:"ma-20",style:{width:"150rpx"}},{default:o((()=>[_(j,{height:150,width:150})])),_:1}),_(T,null,{default:o((()=>[_(T,{class:"",style:{width:"400rpx"}},{default:o((()=>[_(j,{height:35,width:400})])),_:1}),_(T,{class:"",style:{width:"400rpx"}},{default:o((()=>[_(j,{height:35,width:400})])),_:1}),_(T,{class:"",style:{width:"400rpx"}},{default:o((()=>[_(j,{height:35,width:400})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}))),64)):(l(),a(T,{key:1},{default:o((()=>[(l(!0),r(d,null,c(s.material_item.item_list,((t,e)=>(l(),a(C,{shadow:4,round:5,padding:[20,20],margin:[20,10],blur:!0,width:660},{default:o((()=>[x.vk.getVuex("$app.mp_ad_obj.banner")&&e%8==1?(l(),a(T,{key:0},{default:o((()=>[_(S,{"unit-id":x.vk.getVuex("$app.mp_ad_obj.banner")},null,8,["unit-id"])])),_:1})):m("",!0),_(T,{class:"flex flex-row flex-between px-10 py-2",onClick:i=>y.to_change_choose(t,e)},{default:o((()=>[_(T,{class:"flex flex-row"},{default:o((()=>[_(T,{class:"flex-1 shadow-10 mr-12 round-4"},{default:o((()=>[_(N,{class:"shadow-10",src:t.cloud_url+"?x-oss-process=image/resize,w_155,m_lfit",style:{width:"150rpx",height:"150rpx"},mode:"aspectFill"},null,8,["src"])])),_:2},1024),_(T,{class:"flex-3 flex flex-col flex-between"},{default:o((()=>[_(Q,{color:"grey",_class:"text-overflow-1",class:"text-overflow-1",label:"昵称:无名氏"}),_(Q,{color:"grey",class:"text-overflow-1",label:"简介:此人很懒,没有介绍"}),_(T,{class:"flex flex-row flex-start flex-col-center-center"},{default:o((()=>[_(Q,{class:"shadow-2 round-10 px-8 ma-10 text-size-xs",color:"grey",fontSize:24,label:"+状态"}),_(T,{class:"flex flex-row"},{default:o((()=>[(l(),r(d,null,c(3,(e=>_(N,{src:t.cloud_url+"?x-oss-process=image/resize,w_25,m_lfit",style:{"margin-right":"-18rpx","border-radius":"20rpx",width:"40rpx",height:"40rpx"}},null,8,["src"]))),64))])),_:2},1024),_(T,{class:"ml-20"},{default:o((()=>[_(Q,{color:"grey",class:"text-overflow-1",fontSize:24,label:"等"+(11+e)%100+"个朋友"},null,8,["label"])])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024),_(T,{class:"flex-1 flex flex-row flex-center flex-col-center-center"},{default:o((()=>[_($,{color:"grey","font-size":30,class:"ma-10",name:"tmicon-qrcode"}),_($,{color:"grey","font-size":20,class:"ma-10",name:"tmicon-angle-right"}),"choose"==s.action?(l(),a(F,{key:0,checked:t.had_choose,disabled:!0},null,8,["checked"])):m("",!0)])),_:2},1024)])),_:2},1032,["onClick"])])),_:2},1024)))),256))])),_:1}))])),_:1})}],["__scopeId","data-v-57ab0f95"]])},computed:{},data:()=>({vk:uni.vk,dbName:"avatar",is_fixed:!1,choose_list_drawer_show:!1,first_loding:!0,action:"view",up_tips_show:!0,choose_show:!1,hideBtn:!1,is_full:!1,is_loading:!1,active_tabs_index:0,current_cid:1,current_index:0,current_id:"",current_zh_type:"全部",current_item:{},windowHeight:"",had_choose_list:[],category_list:[{cid:"0",title:"全部",zh_type:"全部",item_list:[]},{cid:"1",title:"情侣",zh_type:"情侣",item_list:[]},{cid:"2",title:"动漫",zh_type:"动漫",item_list:[]},{cid:"3",title:"卡通",zh_type:"卡通",item_list:[]},{cid:"4",title:"男生",zh_type:"男生",item_list:[]},{cid:"5",title:"女生",zh_type:"女生",item_list:[]},{cid:"6",title:"流行",zh_type:"QQ",item_list:[]},{cid:"7",title:"现代",zh_type:"微信",item_list:[]},{cid:"8",title:"美女",zh_type:"美女",item_list:[]},{cid:"9",title:"闺蜜",zh_type:"闺蜜",item_list:[]},{cid:"10",title:"欧美",zh_type:"欧美",item_list:[]},{cid:"11",title:"个性",zh_type:"个性",item_list:[]},{cid:"12",title:"可爱",zh_type:"可爱",item_list:[]},{cid:"13",title:"黑白",zh_type:"黑白",item_list:[]},{cid:"14",title:"风景",zh_type:"风景",item_list:[]},{cid:"15",title:"非主流",zh_type:"非主流",item_list:[]},{cid:"16",title:"其他",zh_type:"其他",item_list:[]}],scrollTop:0,show_to_top:!1,nickname_list:[],avatar_list:[],can_max_choose:100}),onPageScroll(t){t.scrollTop>200?this.show_to_top=!0:this.show_to_top=!1},async onReachBottom(){console.log("触底"),await this.get_list_data()},methods:{previewImage(t){console.log("预览图片",t),p({current:t,urls:[t],loop:!0,longPressActions:{itemList:[],success:function(t){console.log("选中了第"+(t.tapIndex+1)+"个按钮,第"+(t.index+1)+"张图片")},fail:function(t){console.log(t.errMsg)}}})},async tabs_change(t){this.active_tabs_index=t,this.current_zh_type=this.category_list[this.active_tabs_index].zh_type,0==this.category_list[this.active_tabs_index].item_list.length&&(this.first_loding=!0,await this.get_list_data(),setTimeout((()=>{this.first_loding=!1}),500))},async choose_platform(t){console.log("e",t);let{index:e,data:i}=t;"QQ"==i?console.log("打开QQ小程序"):"微信"==i&&console.log("打开微信小程序")},to_top(){x({scrollTop:0,duration:300})},async get_list_data(){if(console.log("-------------加载数据-------------------"),this.is_loadding)return;this.is_loadding=!0;let t={};"全部"!=this.current_zh_type&&(t={zh_type:this.current_zh_type});let e=await T(this.dbName,t,1,20);if(console.log("res",e),0==e.code&&null!=e.data){let t=e.data;for(let e=0;e<t.length;e++)t[e].had_choose=!1;console.log("img_data",t),this.category_list[this.active_tabs_index].item_list=[...this.category_list[this.active_tabs_index].item_list,...t]}else if(0==e.code&&null==e.data)return;this.is_loadding=!1}},async onLoad(t={}){this.first_loding=!0,this.action=t.action||"view",this.active_tabs_index=parseInt(t.active_tabs_index)||0,this.current_cid=this.active_tabs_index+1||1;let e=(null==t?void 0:t.id)||"";e&&await this.to_get_avatar_byId(e);let i=await C("nickname",{},100);this.nickname_list=i.data},async onReady(){await this.get_list_data(),setTimeout((()=>{this.first_loding=!1}),200)}},[["render",function(e,i,s,m,u,f){const g=w(h("tm-message"),t),p=w(h("tm-tabs"),v),x=n,T=w(h("tm-skeleton-line"),b),C=w(h("tm-sheet"),k),I=y("avatar-card"),S=w(h("tm-icon"),z),N=w(h("tm-app"),j);return l(),a(N,null,{default:o((()=>[_(g,{ref:"toast"},null,512),_(x,{class:"fixed zIndex-10"},{default:o((()=>[_(p,{list:u.category_list,border:1,width:750,height:300,"default-name":u.active_tabs_index,round:2,color:"grey",activeName:u.active_tabs_index,itemModel:"line",text:"",activeFontColor:"primary",unSelectedColor:"grey-darken-2",onChange:f.tabs_change},null,8,["list","default-name","activeName","onChange"])])),_:1}),_(x,{style:{"margin-top":"100rpx"}},{default:o((()=>[u.first_loding?(l(),r(d,{key:0},c(20,((t,e)=>_(x,null,{default:o((()=>[_(C,{_class:"shadow-1 round-5",class:"round-5",padding:[20,30],margin:[25,10]},{default:o((()=>[_(x,{class:"flex flex-row flex-start"},{default:o((()=>[_(x,{class:"ma-20",style:{width:"150rpx"}},{default:o((()=>[_(T,{height:150,width:150})])),_:1}),_(x,null,{default:o((()=>[_(x,{class:"",style:{width:"400rpx"}},{default:o((()=>[_(T,{height:35,width:400})])),_:1}),_(x,{class:"",style:{width:"400rpx"}},{default:o((()=>[_(T,{height:35,width:400})])),_:1}),_(x,{class:"",style:{width:"400rpx"}},{default:o((()=>[_(T,{height:35,width:400})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}))),64)):(l(),a(x,{key:1},{default:o((()=>[_(I,{material_item:u.category_list[u.active_tabs_index],first_loding:u.first_loding,onClick_down:e.click_down,onTo_change_choose:e.to_change_choose,action:u.action},null,8,["material_item","first_loding","onClick_down","onTo_change_choose","action"])])),_:1}))])),_:1}),_(x,{style:{"margin-bottom":"250rpx"}},{default:o((()=>[_(S,{spin:"","font-size":50,name:"tmicon-loading",color:"blue"})])),_:1})])),_:1})}],["__scopeId","data-v-4de7ec0f"]]);export{N as default};
