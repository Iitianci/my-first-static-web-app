import{T as e,o as t,c as a,w as n,b as i,e as o,l as s,j as l,h as r}from"./index-f5cba0e4.js";import{_ as c}from"./tm-button.37a1a22f.js";import{r as _}from"./uni-app.es.62a9cda9.js";import{_ as u}from"./tm-app.c7c4bc54.js";import{_ as h}from"./_plugin-vue_export-helper.1b428a4d.js";import"./tm-icon.ed97db34.js";import"./useTheme.d1454919.js";import"./useWindowInfo.47d82cea.js";(new Date).getTime();const p=h({data:()=>({url_link:"",url_scheme:"",current_h5_env:"",in_wx_h5:!1,extraData:{}}),async onLoad(e={}){if(console.log("onload options",e),this.init_env(),null==e?void 0:e.extraData)if(console.log("options extraData",JSON.parse(e.extraData)),this.extraData=JSON.parse(e.extraData),"tg_tran"==e.event_type){let t=`weixin://dl/business/?appid=${e.appid||"wx309b6292f688747a"}&path=${e.path?e.path.replace("/pages/","pages/"):"pages/matetial/detail"}&query=${encodeURIComponent(`extraData=${encodeURIComponent(e.extraData)}`)}&env_version=${e.env_version||"release"}`;this.url_scheme=t,console.log("this.url_scheme",this.url_scheme),window.location=this.url_scheme}else"android"==this.current_h5_env?this.create_url_link(e):"ios"==this.current_h5_env&&this.create_url_scheme(e)},methods:{async to_test(e){},to_open_scheme(){window.location=this.url_scheme},async create_url_link(e){let t=await uni.vk.callFunction({url:"mp_wx/pub/create_url_link",title:"请求中...",data:{appid:e.appid||"wx309b6292f688747a",path:e.path||"/pages/matetial/detail",query:"extraData="+encodeURIComponent(null==e?void 0:e.extraData),env_version:e.env_version||"release"},env:"api"});0==t.code&&(this.url_link=t.data.url_link,window.location=this.url_link)},async create_url_scheme(e){let t=await uni.vk.callFunction({url:"mp_wx/pub/create_url_scheme",title:"请求中...",data:{appid:e.appid||"wx309b6292f688747a",path:e.path||"/pages/matetial/detail",query:"extraData="+encodeURIComponent(null==e?void 0:e.extraData),env_version:e.env_version||"release"},env:"api"});0==t.code&&(console.log("dataRes",t.data),this.url_scheme=t.data.url_scheme,window.location=this.url_scheme)},init_env(){const e=navigator.userAgent.toLowerCase();"micromessenger"==e.match(/MicroMessenger/i)?this.in_wx_h5=!0:this.in_wx_h5=!1;const t=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e),a=/Android/i.test(e),n=/iPhone|iPad|iPod/i.test(e);t?(console.log("当前环境是手机"),a?(console.log("当前环境是安卓"),this.current_h5_env="android"):n&&(console.log("当前环境是苹果"),this.current_h5_env="ios")):(console.log("当前环境是电脑"),this.current_h5_env="pc")},to_copy_scheme(){this.url_scheme?e({data:this.url_scheme,success:e=>{uni.vk.alert("复制链接成功,请在微信聊天框粘贴之后发送,再点击链接,或者直接粘贴到游览器搜索即可!")}}):uni.vk.alert("内容为空,无法复制!")},to_copy_url(){this.url_link||this.url_scheme?e({data:this.url_link||this.url_scheme,success:e=>{uni.vk.alert("复制链接成功,请在微信聊天框粘贴发送,再再点击链接,或者直接粘贴到游览器搜索即可!")}}):uni.vk.alert("内容为空,无法复制!")}}},[["render",function(e,h,p,d,m,x){const v=s,f=l,w=_(r("tm-button"),c),k=_(r("tm-app"),u);return t(),a(k,null,{default:n((()=>[i(f,{class:"mt-n24 flex flex-row flex-center"},{default:n((()=>[i(v,{class:"text-weight-b"},{default:n((()=>[o("正在跳转中.. 请稍等!")])),_:1})])),_:1}),i(f,{class:"mt-n24 flex flex-row flex-center"},{default:n((()=>[i(w,{label:"长时间无法跳转?点此解决!",width:600,round:20,onClick:x.to_copy_url},null,8,["onClick"])])),_:1}),i(f,{class:"mt-n24 flex flex-row flex-around fixed b-n20 r-0",style:{width:"750rpx"}},{default:n((()=>[i(v,{onClick:x.to_test},{default:n((()=>[o(" 测试 ")])),_:1},8,["onClick"]),i(v,{onClick:x.to_open_scheme},{default:n((()=>[o(" 重新打开 ")])),_:1},8,["onClick"]),i(v,{onClick:x.to_copy_scheme},{default:n((()=>[o(" 复制 ")])),_:1},8,["onClick"])])),_:1})])),_:1})}]]);export{p as default};
