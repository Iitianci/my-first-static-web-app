import{q as e,u as t,v as l,x as a,C as o,$ as i,y as r,z as n,A as u,a0 as s,K as d,a1 as v,o as c,c as h,w as f,D as p,E as m,G as g,a2 as y,f as x,b,d as w,F as k,r as _,j as T,V as M}from"./index-f5cba0e4.js";import{_ as N}from"./tm-sheet.38d3d718.js";import{t as S}from"./tm-text.d010834d.js";import{_ as C}from"./tm-icon.ed97db34.js";import{_ as A}from"./tm-badge.vue_vue_type_script_setup_true_lang.38983ab0.js";import{c as L,u as I,a as $}from"./uni-app.es.62a9cda9.js";import{_ as D}from"./_plugin-vue_export-helper.1b428a4d.js";const z=D(e({__name:"tm-tabs",props:{...L,list:{type:Array,default:()=>[]},rangKey:{type:String,default:"title"},color:{type:String,default:"white"},transprent:{type:[Boolean,String],default:!1},width:{type:Number,default:500},itemHeight:{type:Number,default:80},height:{type:Number,default:1e3},gutter:{type:Number,default:0},defaultName:{type:[String,Number],default:""},activeName:{type:[String,Number],default:""},tabPos:{type:String,default:"top"},itemWidth:{type:Number,default:0},activeColor:{type:String,default:"primary"},activeFontColor:{type:String,default:"primary"},activeFontSize:{type:Number,default:28},itemModel:{type:String,default:"text"},unSelectedColor:{type:String,default:""},itemFontSize:{type:Number,default:28},itemLinear:{type:String,default:""},itemLinearDeep:{type:String,default:"light"},itemRound:{type:Number,default:0},align:{type:String,default:"left"},swiper:{type:Boolean,default:!1},showTabsLineAni:{type:Boolean,default:!1},showTabsLine:{type:Boolean,default:!0},tabsLineAniColor:{type:String,default:"primary"},disAbledPull:{type:Boolean,default:!0},darkBgColor:{type:String,default:""},subtract:{type:Number,default:2}},emits:["update:activeName","change","click"],setup(e,{expose:L,emit:D}){var z;const H=e,B=I();null==(z=t())||z.proxy,l(null),a((()=>H.disAbledPull));const X=a((()=>{let e={right:"flex-row-center-end",left:"flex-row-center-start",center:"flex-row-center-center",around:"flex-around"},t="center";return e.hasOwnProperty(H.align)&&(t=H.align),e[t]})),F=l(H.defaultName);D("update:activeName",F.value);const P=a((()=>$(H))),W=l(""),j=a((()=>"text"==H.itemModel?{transprent:!0,border:0,text:!1}:"line"==H.itemModel?{transprent:!0,border:4,text:!1}:"textLight"==H.itemModel?{transprent:!1,border:4,text:!0}:"card"==H.itemModel?{transprent:!1,border:0,text:!1}:{transprent:!0,border:0,text:!1})),E=a((()=>H.tabPos)),K=l([]),Y=a((()=>H.list.length>0)),O="tabs_id_"+uni.$tm.u.getUid(1)+"_",R=l(!1);Math.ceil(o(H.itemHeight));const U=a((()=>o(K.value.length*H.width))),q=Math.ceil(o(H.itemWidth));Math.ceil(o(40));const G=Math.ceil(o(H.width)),J=a((()=>{let e=H.itemWidth*K.value.length;return e<=H.width&&(e=H.width),e}));a((()=>{let e=q*K.value.length;return e<=H.width&&(e=o(H.width)),Math.ceil(e)}));const V=l(0);let Q=NaN,Z=NaN;const ee=l(0),te=l(0);l(0),l(0);const le=l(0),ae=l(0);l(0),l(0);const oe=l(0),ie=l(!0),re=a((()=>K.value.findIndex((e=>e.key==F.value))));let ne=1,ue=!1,se=l("none"),de=l(!1),ve=o(40),ce=l(ve);function he(e=""){if(!H.showTabsLineAni)return;let t=e||F.value,l=K.value.findIndex((e=>e.key==t));if(l>-1){let e=q*l;"center"==H.align&&(e=e+(G-q*K.value.length)/2-1),V.value=Math.ceil(e)}}i((()=>{K.value=[],H.list.forEach(((e,t)=>{K.value.push({key:(null==e?void 0:e.key)??(null==e?void 0:e.id)??String(t),title:e[H.rangKey]??String(t),icon:(null==e?void 0:e.icon)??"",dot:(null==e?void 0:e.dot)??!1,count:(null==e?void 0:e.count)??"",dotColor:(null==e?void 0:e.dotColor)??"red"})}))})),r((()=>H.activeName),(()=>{H.activeName!=F.value&&xe(H.activeName,!1,!1)})),n((()=>{setTimeout((()=>{W.value=O+F.value,u((()=>{he(H.defaultName)}))}),300)})),i((()=>{oe.value=Math.ceil(o(-re.value*H.width)),function(e,t,l=ne){if(!H.swiper);}(0,o(re.value*H.width),ne)})),r((()=>F.value),(()=>{u((()=>{var e,t;let l=K.value.findIndex((e=>e.key==F.value));l>-1?void 0!==K.value[l-H.subtract]?W.value=O+(null==(e=K.value[l-H.subtract])?void 0:e.key):W.value=O+(null==(t=K.value[0])?void 0:t.key):W.value=O+F.value,he()}))}));let fe=l(!1);function pe(e){if(H.swiper)if(ie.value=!0,ue=!0,fe.value=!1,de.value=!0,-1==e.type.indexOf("mouse")&&1==e.changedTouches.length){var t=e.changedTouches[0];void 0!==(null==t?void 0:t.pageX)?(ee.value=t.pageX-0,te.value=t.pageY-0):(ee.value=t.x,te.value=t.y)}else ee.value=e.pageX-e.currentTarget.offsetLeft-0,te.value=e.pageY-e.currentTarget.offsetTop-0}function me(e){if(!H.swiper||0==ue)return;fe.value=!0;let t=0,l=0;if(-1==e.type.indexOf("mouse")&&1==e.changedTouches.length){var a=e.changedTouches[0];void 0!==(null==a?void 0:a.pageX)?(t=a.pageX-0,l=a.pageY-0):(t=a.x,l=a.y)}else t=e.pageX-e.currentTarget.offsetLeft-0,l=e.pageY-e.currentTarget.offsetTop-0;le.value=t-ee.value,ae.value=l-te.value,ye(le.value,ae.value)}function ge(e){H.swiper&&ue&&fe.value&&(ie.value=!1,fe.value=!1,function(e,t=500,l=!1){if(isNaN(Z)||clearTimeout(Z),l){var a=!Z;Z=setTimeout((()=>{Z=NaN}),t),a&&"function"==typeof e&&e()}else Z=setTimeout((()=>{"function"==typeof e&&e()}),t)}((()=>{ye(le.value,ae.value,!0),de.value=!1}),250,!0),ue=!1)}function ye(e,t,l=!1){re.value;let a=o(re.value*H.width);if(function(e,t=500,l=!1){if(isNaN(Q)||clearTimeout(Q),l){var a=!Q;Q=setTimeout((()=>{Q=NaN}),t),a&&"function"==typeof e&&e()}else Q=setTimeout((()=>{"function"==typeof e&&e()}),t)}((()=>{e>0&&Math.abs(e)>Math.abs(t)?se.value="right":e<0&&Math.abs(e)>Math.abs(t)?se.value="left":t>0&&Math.abs(t)>Math.abs(e)?se.value="down":t<0&&Math.abs(t)>Math.abs(e)?se.value="up":se.value="none"}),300,!0),"right"==se.value){if(0==re.value)return;oe.value=e-a;let t=1.05*Math.abs(ve);t=Math.min(t,ve),t=Math.max(t,q),ce.value=t,l&&(e<80||re.value<=0?oe.value=-a:(F.value=(null==(i=K.value[re.value-1])?void 0:i.key)??-1,xe(F.value,!1)),ce.value=ve)}else if("left"==se.value){if(re.value==K.value.length-1)return;oe.value=e-a;let t=1.0002*Math.abs(le.value);t=Math.min(t,ve),t=Math.max(t,q),ce.value=t,l&&(!function(){var t;Math.abs(e)<80||re.value>=K.value.length-1?oe.value=-a:(F.value=(null==(t=K.value[re.value+1])?void 0:t.key)??-1,xe(F.value,!1))}(),ce.value=ve)}var i}function xe(e,t=!0,l=!0){ie.value=!0,F.value=e,ne=1,D("update:activeName",d(F.value)),l&&u((()=>{D("change",e)})),t&&u((()=>{D("click",e)}))}return s((()=>{})),v("tabsActiveName",a((()=>F.value))),v("tabsActiveactiveIndex",re),v("tabsActiveCacheTabse",a((()=>K.value))),v("tabsWidth",a((()=>H.width))),v("tabsheight",a((()=>H.height?H.height-H.itemHeight-H.gutter:0))),v("tabsSwiper",a((()=>H.swiper))),v("tabsSwiperIsMoveing",a((()=>fe.value))),v("tabsSwiperDisAbledPull",a((()=>H.disAbledPull))),L({pushKey:function(e){var t;let l=K.value.findIndex((t=>t.key===e.key));l>-1?K.value.splice(l,1,{...K.value[0],...e}):K.value.push(e),""==F.value&&xe((null==(t=K.value[0])?void 0:t.key)??-1,!1)},changeKey:xe,unbindKey:function(e){var t;let l=K.value.findIndex((t=>t.key==e));l>-1&&K.value.splice(l,1),-1==K.value.findIndex((e=>e.key==F.value))&&K.value.length>0?xe((null==(t=K.value[0])?void 0:t.key)??"",!1,!1):0==K.value.length&&xe("",!1,!1)},setTitle:function(e){let t=K.value.findIndex((t=>t.key==e.key));t>-1&&K.value.splice(t,1,e)},tmTabsId:"tmTabsId"}),(t,l)=>{const a=T,o=M;return c(),h(a,{class:"flex flex-col overflow",style:m([H.height&&!p(Y)&&K.value.length>0?{height:e.height+"rpx"}:"",{width:H.width+"rpx"}])},{default:f((()=>["bottom"!=p(E)||p(Y)?x("",!0):(c(),h(a,{key:0,onTouchmove:me,onTouchend:ge,onTouchstart:pe,onMousemove:me,onMouseup:ge,onMouseleave:ge,onMousedown:pe,ref:"tabsDom",style:m({width:H.swiper?`${p(U)}px`:`${H.width}rpx`,transform:H.swiper?`translateX(${oe.value}px)`:"translateX(0px)"}),class:g([[!ie.value||R.value?"tmTabsPane":""],"flex flex-row flex-nowrap overflow"])},{default:f((()=>[y(t.$slots,"default",{},void 0,!0)])),_:3},8,["style","class"])),b(N,{darkBgColor:H.darkBgColor,transprent:H.transprent,color:H.color,followTheme:H.followTheme,dark:H.dark,round:H.round,shadow:H.shadow,outlined:H.outlined,border:H.border,borderStyle:H.borderStyle,borderDirection:H.borderDirection,text:H.text,linear:H.linear,linearDeep:H.linearDeep,margin:[0,0],padding:[0,0],height:H.itemHeight+p(j).border+H.gutter+4,_class:["flex-center flex-row nonvue",p(P)],_style:H._style,width:H.width},{default:f((()=>[b(o,{style:m([{width:`${H.width}rpx`,height:`${H.itemHeight+4}rpx`}]),"scroll-with-animation":!0,"scroll-into-view":W.value,"scroll-x":!0,"show-scrollbar":!1,"enable-flex":"",class:"tableHeader flex-row relative"},{default:f((()=>[b(a,{class:g(["flex flex-row nowrap nonvue fulled",[p(X)]]),style:m([{height:`${H.itemHeight+4}rpx`}])},{default:f((()=>[(c(!0),w(k,null,_(K.value,((e,t)=>(c(),h(a,{id:O+e.key,key:t,class:"flex flex-shrink"},{default:f((()=>[b(N,{onClick:t=>xe(e.key),round:H.itemRound,linear:H.itemLinear,linearDeep:H.itemLinearDeep,borderDirection:"bottom",text:e.key===F.value&&p(j).text,border:e.key===F.value?p(j).border:0,transprent:e.key!==F.value||p(j).transprent,color:H.activeColor&&e.key===F.value?H.activeColor:H.color,width:H.itemWidth,_class:"flex-col flex-col-center-center",margin:[0,0],padding:[0,0],height:H.itemHeight},{default:f((()=>[b(a,{style:m([H.itemWidth>0?{width:H.itemWidth+"rpx"}:{paddingLeft:"20rpx",paddingRight:"20rpx"},{height:H.itemHeight+"rpx"}]),class:"flex flex-row flex-row-center-center relative flex-shrink"},{default:f((()=>[b(a,{class:"flex flex-row flex-center"},{default:f((()=>[e.icon?(c(),h(C,{key:0,userInteractionEnabled:!1,_class:"pr-5",color:e.key===F.value?H.activeFontColor:H.unSelectedColor,"font-size":e.key===F.value?H.activeFontSize:H.itemFontSize,name:e.icon},null,8,["color","font-size","name"])):x("",!0),b(S,{userInteractionEnabled:!1,"font-size":e.key===F.value?H.activeFontSize:H.itemFontSize,_class:e.key===F.value?"text-weight-b":"",color:e.key===F.value?H.activeFontColor:H.unSelectedColor,label:e.title},null,8,["font-size","_class","color","label"])])),_:2},1024),!e.count&&e.dot?(c(),h(a,{key:0,userInteractionEnabled:!1,style:m({height:"12rpx",top:"12rpx",right:"-16rpx",width:R.value?"flex-1":"100%"}),class:"absolute t-0 r-0 flex flex-row flex-row-center-end"},{default:f((()=>[b(A,{dot:"",color:e.dotColor},null,8,["color"])])),_:2},1032,["style"])):x("",!0),e.count&&!e.dot?(c(),h(a,{key:1,userInteractionEnabled:!1,style:m({height:H.itemHeight-30+"rpx",top:"10rpx",right:H.showTabsLineAni?0:"-16rpx",width:R.value?"flex-1":"100%"}),class:"absolute t-0 r-0"},{default:f((()=>[b(A,{count:e.count,color:e.dotColor},null,8,["count","color"])])),_:2},1032,["style"])):x("",!0)])),_:2},1032,["style"])])),_:2},1032,["onClick","round","linear","linearDeep","text","border","transprent","color","width","height"])])),_:2},1032,["id"])))),128))])),_:1},8,["class","style"]),H.showTabsLineAni&&H.itemWidth>0&&H.showTabsLine?(c(),h(a,{key:0,class:"anilineBar absolute l-0",style:m({width:`${p(J)}rpx`,height:"1px",top:`${H.itemHeight}rpx`,backgroundColor:H.showTabsLineAni?p(B).tmStore.dark?"#616161":"#ebebeb":""})},null,8,["style"])):x("",!0),H.showTabsLineAni&&H.itemWidth>0?(c(),h(a,{key:1,class:"anilineBar absolute l-0 b-0 flex flex-row flex-center",style:m({transform:`translateX(${V.value}px)`,top:H.itemHeight-2+"rpx",width:p(q)+"px",height:"4px"})},{default:f((()=>[b(N,{parenClass:"animateAll_tabs_tmui","follow-dark":!1,color:H.tabsLineAniColor,width:p(ce),unit:"px",height:4,margin:[0,0],padding:[0,0]},null,8,["color","width"])])),_:1},8,["style"])):x("",!0)])),_:1},8,["style","scroll-into-view"])])),_:1},8,["darkBgColor","transprent","color","followTheme","dark","round","shadow","outlined","border","borderStyle","borderDirection","text","linear","linearDeep","height","_class","_style","width"]),"top"!=p(E)||p(Y)?x("",!0):(c(),h(a,{key:1,id:"webIdTabs",onTouchmove:me,onTouchend:ge,onTouchstart:pe,onTouchcancel:ge,onMousemove:me,onMouseup:ge,onMouseleave:ge,onMousedown:pe,ref:"tabsDom",style:m({width:H.swiper?`${p(U)}px`:`${H.width}rpx`,transform:H.swiper?`translateX(${oe.value}px)`:"translateX(0px)"}),class:g([[!ie.value||R.value?"tmTabsPane":""],"flex flex-row flex-nowrap overflow"])},{default:f((()=>[y(t.$slots,"default",{},void 0,!0)])),_:3},8,["style","class"]))])),_:3},8,["style"])}}}),[["__scopeId","data-v-e23431ae"]]);export{z as _};
