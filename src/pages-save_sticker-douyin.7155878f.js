import{s as e,n as t,g as s,ab as o,M as l,o as i,c as a,w as c,j as n,b as r,d as u,r as h,F as m,e as d,h as _,l as g,t as p,E as f,i as x}from"./index-f5cba0e4.js";import{_ as w}from"./tm-carousel.vue_vue_type_script_setup_true_lang.5fe38e15.js";import{r as v}from"./uni-app.es.62a9cda9.js";import{_ as y}from"./tm-button.37a1a22f.js";import{_ as b}from"./tm-modal.70c18b3d.js";import{_ as k}from"./_plugin-vue_export-helper.1b428a4d.js";import"./tm-image.vue_vue_type_script_setup_true_lang.e60a99a6.js";import"./tm-sheet.38d3d718.js";import"./useTheme.d1454919.js";import"./tm-text.d010834d.js";import"./tm-icon.ed97db34.js";import"./tm-translate.1353da0c.js";import"./tm-overlay.d3e45220.js";import"./useWindowInfo.47d82cea.js";let T=0;const j=k({data:()=>({openid:"",msg_list:[],msgid:"",down_img_list:[],current_url:"",token:"",cookies:"",preview_img_show:!1,touching:!1,overdue:!0,hasMore:!0,listimg:["https://picsum.photos/200/300?id=43335","https://picsum.photos/200/300?id=433","https://picsum.photos/200/300?id=439","https://picsum.photos/200/300?id=459"]}),onShow(){console.log("onshow"),setTimeout((()=>{this.show_interstitialAd()}),7e3),console.log("å°šæœªè·³è½¬è¿‡å¹¿å‘Š")},onHide(){console.log("onhide"),console.log("å°šæœªç‚¹å‡»çœ‹å¹¿å‘Š")},async onReachBottom(){console.log("è§¦åº•"),await this.get_sticker()},async onLoad(e={}){await this.get_sticker(),setInterval((()=>{this.touching=!1}),2e3)},computed:{img_style(){let e={filter:"blur(20px)"};return this.touching&&(e={}),e}},methods:{touchcancel(){this.touching=!1},touchmove(){0==this.touching&&(this.touching=!0)},touchend(){console.log("@touchend"),this.touching=!1},touchstart(){console.log("touchstart"),this.touching=!0},async get_sticker(){if(console.log("è·å–æ•°æ®----------------"),!this.hasMore)return void console.log("æ²¡æœ‰æ›´å¤šäº†");let e=await uni.vk.callFunction({url:"client/douyin/pub/comment_list",title:"è¯·æ±‚ä¸­...",data:{cursor:T,item_id:"",count:50}});console.log("dataRes",e);let{code:t,msg:s,has_more:o,cursor:l,data:i}=e;0==t&&(T=l,this.hasMore=o,this.msg_list=[...this.msg_list,...i])},to_mini(){e({title:"æç¤º",content:"è¡¨æƒ…åŒ…å·²å‡†å¤‡å¥½,è¯·å‰å¾€é¢†å–",showCancel:!1,success:e=>{e.confirm&&uni.navigateToMiniProgram({appId:"wxb234a8d765b52bbe",path:"pages/wx_msg/save_sticker",envVersion:"develop",extraData:{msgid:this.msgid,token:this.token,cookies:this.cookies,in_time:0},success:e=>{console.log("è·³è½¬res:",e)}})}})},to_reward_ad(){},show_interstitialAd(){},to_page(e){t({url:e})},to_save_img(e){this.current_url=e,(new Date).getTime(),s("last_reward_ad_time");let t=Math.floor(10*Math.random());console.log("can_view_ad:",true,"rand_num",t),this.to_reward_ad()},async download_img(){},to_save(e){uni.authorize({scope:"scope.writePhotosAlbum",success:()=>{this.saveImg(e)},complete:()=>{uni.getSetting({success:t=>{t.authSetting["scope.writePhotosAlbum"]||this.opensit(e)}})}})},async saveImg(e){e&&o({filePath:e,success:e=>{console.log("res",e),l({title:"ä¿å­˜æˆåŠŸ"})},fail:e=>{console.log("err",e),l({title:"ä¿å­˜å¤±è´¥"})}})},opensit(t){e({content:"æ˜¯å¦æˆæƒå°ç¨‹åºä¿å­˜å›¾ç‰‡åˆ°ç›¸å†Œï¼Ÿ",success:s=>{s.confirm?uni.openSetting({success:e=>{console.log(e.authSetting),this.saveImg(t)}}):s.cancel&&e({cancelText:"ä¾ç„¶å–æ¶ˆ",confirmText:"é‡æ–°æˆæƒ",content:"å¾ˆé—æ†¾ä½ ç‚¹å‡»äº†å–æ¶ˆï¼Œè¿™å°†æ— æ³•è¿›è¡Œä¿å­˜æ“ä½œ",success:e=>{e.confirm?uni.openSetting({success:e=>{console.log(e.authSetting)}}):e.cancel&&console.log("ç”¨æˆ·æ‹’ç»æˆæƒï¼Œæ— æ³•ä¿å­˜å›¾ç‰‡")}})}})}}},[["render",function(e,t,s,o,l,k){const T=v(_("tm-carousel"),w),j=v(_("tm-button"),y),M=n,C=x,S=g,I=v(_("tm-modal"),b);return i(),a(M,{onTouchstart:k.touchstart,onTouchend:k.touchend,onTouchcancel:k.touchcancel,onTouchmove:k.touchmove},{default:c((()=>[r(T,{autoplay:"",margin:[0,16],round:3,width:686,height:300,list:l.listimg},null,8,["list"]),r(M,{class:"flex flex-row flex-center"},{default:c((()=>[r(j,{label:"æŸ¥çœ‹ä½¿ç”¨æ•™ç¨‹",color:"green",width:400,height:80,round:20,onClick:t[0]||(t[0]=e=>k.to_page("/pages/web/web"))})])),_:1}),(i(!0),u(m,null,h(l.msg_list,((t,s)=>(i(),a(M,null,{default:c((()=>[r(M,{class:"felx flex-row flex-center"},{default:c((()=>[r(M,{class:"white shadow-10 flex flex-row pa-20 ma-20 round-10",style:{width:"500rpx"}},{default:c((()=>[r(C,{src:t.user_info.avatar_url,mode:"aspectFill",style:{width:"60rpx",height:"60rpx","border-radius":"30rpx"}},null,8,["src"]),r(M,{class:"mx-20 px-20"},{default:c((()=>[r(S,{class:"text-size-s"},{default:c((()=>[d(p(t.user_info.screen_name),1)])),_:2},1024),r(S,{class:"text-blue text-size-xs"},{default:c((()=>[d(p(e.vk.pubfn.timeFormat(t.create_time,"yyyy-MM-dd hh:mm:ss")),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024),r(M,{class:"flex flex-row flex-center",style:f(k.img_style)},{default:c((()=>[r(C,{src:t.image_list[0].url_list[0],style:{width:"600rpx"},mode:"widthFix"},null,8,["src"])])),_:2},1032,["style"]),t.image_list[0].url_list[0]?(i(),a(M,{key:0,class:"flex flex-row flex-center"},{default:c((()=>[r(j,{label:"æŸ¥çœ‹/ä¿å­˜",width:400,height:80,round:20,onClick:e=>k.to_save_img(t.image_list[0].url_list[0])},null,8,["onClick"])])),_:2},1024)):(i(),a(M,{key:1,class:"flex flex-row flex-center"},{default:c((()=>[r(j,{label:"ç­‰å¾…åŠ è½½ä¸­",width:400,color:"grey",height:80,round:20})])),_:1}))])),_:2},1024)))),256)),r(I,{color:"white",okColor:"blue",cancelColor:"grey",splitBtn:"",title:"æç¤º",content:"",height:500,overlayClick:!1,okText:"å¥½çš„",width:700,show:l.preview_img_show,"onUpdate:show":t[1]||(t[1]=e=>l.preview_img_show=e),onOk:k.to_reward_ad,closeable:"",cancelText:"å–æ¶ˆ"},{default:c((()=>[r(M,null,{default:c((()=>[r(M,{class:"flex flex-row flex-center"},{default:c((()=>[r(S,{class:"text-weight-b text-red text-size-g"},{default:c((()=>[d("ç”Ÿæ´»ä¸æ˜“,æœ›æ”¯æŒ")])),_:1})])),_:1}),r(M,{class:"flex flex-col"},{default:c((()=>[r(M,{class:""},{default:c((()=>[r(S,{class:"text-red"},{default:c((()=>[d("è§‚çœ‹å®Œæ•´è§†é¢‘ä¹‹å")])),_:1})])),_:1}),r(M,{class:""},{default:c((()=>[r(S,{class:"text-red"},{default:c((()=>[d('ç‚¹å‡»åº•éƒ¨çš„"äº†è§£æ›´å¤š","ç«‹åˆ»é¢†å–","å…³æ³¨","æŸ¥çœ‹"ç­‰æŒ‰é’®')])),_:1})])),_:1}),r(M,{class:"flex flex-row"},{default:c((()=>[r(S,{class:"text-blue"},{default:c((()=>[d("è·³è½¬ä¹‹åé¢„è§ˆ2-5ç§’å†è¿”å›å³å¯")])),_:1})])),_:1}),r(M,{class:"flex flex-row"},{default:c((()=>[r(S,null,{default:c((()=>[d("ä½ çš„æ”¯æŒæ˜¯æˆ‘çš„åŠ¨åŠ›,èµä¸ªğŸ—å§")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["show","onOk"])])),_:1},8,["onTouchstart","onTouchend","onTouchcancel","onTouchmove"])}]]);export{j as default};
